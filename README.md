# MVU Variable Framework - SillyTavern独立扩展

## 📖 简介

MVU变量框架是一个强大的SillyTavern扩展，用于管理角色卡的变量系统。本版本为**独立扩展版本**，不再依赖酒馆助手，可以直接安装到SillyTavern中使用。

## ✨ 主要功能

- 🎯 **变量管理** - 完整的变量创建、更新和删除功能
- 🔄 **自动更新** - 支持随AI输出自动更新变量
- 📊 **变量追踪** - 实时显示变量变化历史
- 💾 **快照系统** - 保存和恢复变量状态
- 🧹 **自动清理** - 智能管理旧楼层变量，减小文件大小

## 📦 安装指南

### 方法一：手动安装（推荐小白使用）

1. **下载扩展文件**
   - 下载整个 `mvu-extension` 文件夹

2. **找到SillyTavern的扩展目录**
   - Windows: `SillyTavern\public\scripts\extensions\third-party\`
   - Mac/Linux: `SillyTavern/public/scripts/extensions/third-party/`

3. **复制文件**
   - 将 `mvu-extension` 文件夹复制到上述目录中
   - 确保文件结构如下：
   ```
   SillyTavern/
   └── public/
       └── scripts/
           └── extensions/
               └── third-party/
                   └── mvu-extension/
                       ├── manifest.json
                       ├── index.js
                       ├── styles.css
                       └── README.md
   ```

4. **重启SillyTavern**
   - 关闭并重新启动SillyTavern
   - 扩展会自动加载

### 方法二：从扩展管理器安装

1. 在SillyTavern中，点击扩展图标（拼图图标）
2. 找到"管理扩展"选项
3. 搜索 "MVU Variable Framework"
4. 点击"安装"按钮

## 🚀 使用教程

### 基础设置

1. **打开扩展面板**
   - 点击拼图图标打开扩展面板
   - 找到"MVU 变量框架"部分

2. **配置通知设置**
   - ✅ 变量更新出错时通知：出错时显示提示
   - ✅ 额外模型解析中通知：处理时显示进度

3. **选择更新方式**
   - **随AI输出**：变量随着AI的回复自动更新（默认）
   - **额外模型解析**：使用独立的AI模型专门处理变量

### 斜杠命令

```
/mvu - 显示帮助信息
/mvu_set <变量名> <值> - 设置变量值
/mvu_get <变量名> - 获取变量值
/mvu_reset - 重置所有变量
```

### 功能按钮说明

- **重新处理变量** - 重新解析当前消息中的变量
- **重新读取初始变量** - 从世界书重新加载初始变量
- **快照楼层** - 保存指定楼层的变量状态
- **重演楼层** - 从过去的楼层重新计算变量
- **清除旧楼层变量** - 清理旧的变量数据以节省空间

## 🔧 高级配置

### 额外模型解析设置

如果选择"额外模型解析"模式，可以配置：

- **模型来源**：与插头相同 或 自定义
- **API地址**：自定义API的地址
- **API密钥**：访问API所需的密钥
- **模型名称**：使用的模型名称
- **温度**：控制回复的随机性(0-2)
- **频率惩罚**：减少重复内容(-2到2)
- **存在惩罚**：鼓励新话题(-2到2)

### 变量自动清理

- **启用自动清理**：自动清理旧楼层的变量
- **保留楼层数**：保留最近N层的完整变量
- **快照间隔**：每隔N层保留一个快照

## ❓ 常见问题

### Q: 安装后看不到扩展？
A: 请确保：
1. 文件放在正确的目录
2. SillyTavern已重启
3. 扩展面板中已启用该扩展

### Q: 变量没有更新？
A: 检查：
1. 世界书中是否正确配置了变量
2. 更新方式是否选择正确
3. 查看控制台是否有错误信息(F12)

### Q: 聊天文件太大？
A: 使用"清除旧楼层变量"功能，保留最近的楼层即可

### Q: 从酒馆助手版本迁移？
A: 
1. 先导出现有的聊天记录作为备份
2. 卸载酒馆助手版本的MVU
3. 安装此独立版本
4. 变量数据会自动保留

## 🐛 问题反馈

如果遇到问题，请：

1. **收集信息**
   - SillyTavern版本
   - 错误信息（F12控制台）
   - 操作步骤

2. **反馈渠道**
   - GitHub Issues: [链接]
   - Discord: [链接]

## 📝 更新日志

### v1.0.0 (2024-11-18)
- 🎉 首个独立版本发布
- ✨ 移除酒馆助手依赖
- 🔧 优化性能和稳定性
- 📚 完善文档和教程

## 💡 提示

1. **备份重要数据**：在进行大操作前，先导出聊天记录
2. **定期清理**：使用自动清理功能保持文件大小合理
3. **查看控制台**：遇到问题时，F12查看控制台信息有助于诊断

## 📄 许可证

MIT License

---

**注意**：这是MVU的独立扩展版本，专门为不使用酒馆助手的用户设计。如果你已经安装了酒馆助手，请使用酒馆助手版本的MVU。
